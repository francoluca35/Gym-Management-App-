# Servidor Backend - Gym Management App

Servidor Express con MongoDB para la gestión de gimnasios.

## Instalación

1. Instalar dependencias:
```bash
cd server
npm install
```

2. Configurar variables de entorno:
Crea un archivo `.env` en la carpeta `server/` con el siguiente contenido:

**Para MongoDB local:**
```env
PORT=3001
MONGODB_URI=mongodb://localhost:27017/gym-management
NODE_ENV=development
```

**Para MongoDB Atlas (nube):**
```env
PORT=3001
MONGODB_URI=mongodb+srv://usuario:password@cluster.mongodb.net/gym-management?retryWrites=true&w=majority
NODE_ENV=development
```

**Pasos para crear el archivo:**
1. Ve a la carpeta `server/`
2. Crea un nuevo archivo llamado `.env` (sin extensión)
3. Copia y pega el contenido según tu configuración de MongoDB
4. Si usas MongoDB Atlas, reemplaza `usuario:password@cluster.mongodb.net` con tus credenciales reales

3. Asegúrate de tener MongoDB corriendo en tu sistema.

## Ejecución

### Modo desarrollo (con watch):
```bash
npm run dev
```

### Modo producción:
```bash
npm start
```

El servidor estará disponible en `http://localhost:3001`

## Estructura de la Base de Datos

### Colección: gimnasios
- `gymId`: ID único del gimnasio (generado automáticamente)
- `nombreGym`: Nombre del gimnasio
- `direccion`: Dirección del gimnasio
- `telefono`: Teléfono de contacto
- `email`: Email del gimnasio (único)
- `propietario`: Nombre del dueño
- `fechaRegistro`: Fecha de registro
- `activo`: Estado activo/inactivo
- `ipRegistro`: IP de la máquina donde se registró
- `datosFormulario`: Datos adicionales del formulario

### Colección: usuarios
- `gymId`: ID del gimnasio al que pertenece
- `username`: Nombre de usuario (único)
- `password`: Contraseña hasheada
- `rol`: 'admin' o 'empleado'
- `nombre`: Nombre del usuario
- `activo`: Estado activo/inactivo

## Endpoints

### POST /api/auth/register
Registra un nuevo gimnasio y crea el usuario admin + 3 empleados predeterminados.

**Body:**
```json
{
  "nombreGym": "PowerFit Center",
  "propietario": "Juan Pérez",
  "direccion": "Av Siempre Viva 123",
  "telefono": "+54 351 555 5555",
  "email": "contacto@powerfit.com",
  "usuario": "admin",
  "contraseña": "password123"
}
```

### POST /api/auth/login
Inicia sesión con usuario y contraseña.

**Body:**
```json
{
  "usuario": "admin",
  "contraseña": "password123"
}
```

### GET /api/health
Verifica el estado del servidor.
